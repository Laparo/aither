# =============================================================================
# Aither — Hemera Academy API Integration
# =============================================================================
# Copy this file to .env and fill in the values.
# NEVER commit .env to version control.
# =============================================================================

# --- Hemera Academy API ---
# Base URL of the Hemera API (full origin, e.g. https://hemera-academy.vercel.app).
# The client appends /api/service/* paths automatically — do NOT include a path suffix.
HEMERA_API_BASE_URL=https://hemera-academy.vercel.app

# API Key for Hemera service API authentication (M2M).
# This is the client-side copy of the shared secret. It is sent as the
# X-API-Key header to hemera's /api/service/* endpoints.
# On hemera's side the same value must be stored as HEMERA_SERVICE_API_KEY.
# Both variables must contain the exact same Base64url-encoded string (min 32 bytes).
#
# Generate a compliant key:
#   openssl rand -base64 32 | tr '+/' '-_' | tr -d '='
#
# Rotate keys regularly and store them in your secret manager (Vercel/AWS/GCP).
HEMERA_API_KEY=ZXhhbXBsZS1rZXktcmVwbGFjZS1tZS13aXRoLXJlYWw

# --- Clerk Authentication ---
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_...
CLERK_SECRET_KEY=sk_...

# Service User Configuration
# Purpose: Dedicated Clerk user for service-to-service API authentication
# Security Posture:
#   - Limited permissions: api-client role (read courses, update participation results only)
#   - Cannot access admin functions or user management
#   - Tokens are short-lived (15 minutes) and cached with automatic refresh
#   - Principle of least privilege: only the minimum required scopes
# Setup:
#   1. Create a service user in Clerk Dashboard
#   2. Set publicMetadata: { "role": "api-client", "service": "aither" }
#   3. Copy the user ID to CLERK_SERVICE_USER_ID
# Security Best Practices:
#   - Rotate service user credentials every 90 days
#   - Monitor usage logs for suspicious activity
#   - Restrict scopes to only required permissions
#   - Use separate service users for dev/staging/production
# WARNING: Never commit real values to version control. Use .env.local for actual credentials.
CLERK_SERVICE_USER_ID=your-service-user-id
CLERK_SERVICE_USER_EMAIL=your-service-user@example.com

# Note: The Clerk service user (CLERK_SERVICE_USER_ID/CLERK_SERVICE_USER_EMAIL) is used for
# internal Clerk authentication. The HEMERA_API_KEY is a static API key for external
# Hemera API calls (sent as X-API-Key header). These are separate credentials.

# --- SMTP Notifications ---
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=user@example.com
SMTP_PASS=password
SMTP_FROM=aither@example.com
NOTIFY_EMAIL_TO=operator@example.com
NOTIFY_FAILURE_THRESHOLD=3

# --- Rollbar Error Monitoring ---
ROLLBAR_SERVER_TOKEN=your-rollbar-server-token
NEXT_PUBLIC_ROLLBAR_CLIENT_TOKEN=your-rollbar-client-token

# --- Rollbar MCP Server (prefer Read-Only token for automation) ---
# For most integrations use a Read-Only project token. If write access is
# explicitly required for a workflow, configure a separate write-only token.
ROLLBAR_ACCESS_TOKEN_READONLY=your-rollbar-readonly-token
# Optional: only set this if you really need write access for tooling
# ROLLBAR_ACCESS_TOKEN=your-rollbar-read_write-token

# --- Rollbar Control Flags ---
# Use a single flag to enable/disable Rollbar in the public bundle. Set to 0 to
# disable Rollbar entirely. We standardize on `NEXT_PUBLIC_ROLLBAR_ENABLED`.
# Setting this to 0 disables reporting in the public client bundles.
NEXT_PUBLIC_ROLLBAR_ENABLED=1
ROLLBAR_ENABLED=1

# --- Rollbar Sampling Rates (0.0–1.0) ---
# ROLLBAR_SAMPLE_RATE_ALL=1
# ROLLBAR_SAMPLE_RATE_INFO=0.05
# ROLLBAR_SAMPLE_RATE_WARN=0.05
# ROLLBAR_SAMPLE_RATE_ERROR=1
# ROLLBAR_SAMPLE_RATE_CRITICAL=1

# --- Privacy / PII ---
# Set to 1 to allow userId/email in error reports
# NEXT_PUBLIC_TELEMETRY_CONSENT=0
# ROLLBAR_ALLOW_PII=0

# --- E2E Testing ---
# E2E_TEST=0

# --- Postman MCP ---
POSTMAN_API_KEY=your-postman-api-key

# --- Output Directory ---
HTML_OUTPUT_DIR=output

# --- Context7 (Documentation MCP) ---
# API key for Context7 (use a secret key in the format ctx7sk_...)
# Set this value in your local `.env` (never commit real keys into the repo)
# Example: CONTEXT7_API_KEY=ctx7sk_your_api_key_here
CONTEXT7_API_KEY=ctx7sk_your_api_key_here
